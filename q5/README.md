常见的分布式事务协议或者说分布式事务模型，有以下几种:

* XA
* TCC
* SAGA
* AT

## XA分布式事务协议

XA分布式事务协议在现有的单机数据库事务操作模型上微调而来，特点是强一致性，多个数据库之间在事务执行过程中和事务执行后的数据状态是一致的。

优点：对现有代码修改成本较小，且执行过程中数据可以保持强一致性。

缺点：并发处理能力较低，在对数据一致性有非常高要求的场景下需要把数据库的事务隔离级别调整为SERIALIZABLE，非常影响整体的并发能力。且额外引入了事务管理器，增加了维护成本。

适用场景：对数据要求高度一致性，且单个事务持续时间较短的场景，比如金融交易类平台。

## TCC柔性事务模式

TCC模式是一种BASE柔性事务模式，相比于XA事务模式，不需要保证事务过程中数据的强一致性，而是保证在整体事务完成或者回滚之后的最终一致性。在TCC模式中每一个子事务都是独立完整的事务，且新增了Try阶段来完成事务所需要的业务资源的检查和准备。另外TCC模式中也不需要额外的事务管理器，多个子事务的管理交由业务服务自身负责。

优点：不需要额外的事务管理器角色；允许多个数据库之间数据存在暂时的不一致，单个数据库的资源锁定粒度小时间短，并发性能相比于不使用TCC模式只稍微衰退了一些；

缺点：Try阶段的引入导致引入TCC模式时需要对业务代码做很多的修改，且不一定适合当前业务流程，存在较高的引入成本

适用场景：对于并发性能要求较高、允许短暂的数据不一致以及业务流程能够适应Try阶段的场景。

## SAGA柔性事务模式

SAGA模式在TCC模式的基础上，省去了Try阶段，事务直接提交到数据库，并且通过记录事务执行过程中的操作，在回滚时逐个反向执行已提交的事务的方式来实现多个子事务的回滚。

优点：相比TCC模式，在保持相似的性能表现的情况下对业务的适用性更强，不需要对代码做过多改动，降低了代码侵入性。

缺点：需要手动提供事务的回滚恢复操作，在设计存在一定难度，且记录已提交的子事务会带来额外的成本。

适用场景：对于并发性能要求较高、允许短暂的数据不一致的场景。

## AT柔性事务模式

AT模式是SAGA模式的一种优化，把记录并回滚多个子事务的操作交由中间件或者框架来负责，中间件或者框架通过记录用户已提交的事务的SQL，在需要回滚时自动分析SQL并生成一个反向的SQL。

优点：相比SAGA模式省去了记录事务操作与设计事务的回滚恢复操作，进一步降低了对代码的侵入性。

缺点：对于复杂的事务SQL生成正确的反向SQL是很困难的，目前来说还没有一个成熟的AT模式实现。

使用场景：对于并发性能要求较高、允许短暂的数据不一致且事务SQL较为简单的场景。